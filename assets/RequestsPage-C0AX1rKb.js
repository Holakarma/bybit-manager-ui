import{g as E,aM as $,aN as Z,r as p,j as e,am as v,ac as ee,ad as w,aO as C,e as M,T as b,S as x,B as te,G as F,aj as se,aJ as ae,an as ne,L as re,al as R,P as J}from"./index-52-N86DN.js";import{l as O,m as j,j as oe,b as D,h as ie,i as le,k as de,I as ue,R as ce,d as L,e as A,f as he,g,u as me}from"./selectedRequest-DVoYwdnf.js";import{a as I,u as pe,L as G,b as H,c as xe,d as je}from"./index-DGIB4vk0.js";import{i as fe}from"./isEmptyValues-BYo5e0_1.js";const ye=()=>{const s=E();return I({mutationFn:async t=>await O.addCustomRequest(t),mutationKey:["add-custom-request"],onSuccess:()=>{s.invalidateQueries({queryKey:["custom-requests"]})}})},be=()=>{const s=E();return I({mutationFn:async t=>await O.deleteCustomRequest(t),mutationKey:["delete-custom-request"],onSuccess:()=>{s.invalidateQueries({queryKey:["custom-requests"]})}})},we=()=>{const s=E();return I({mutationFn:async({id:t,newCustomRequestData:a})=>await O.updateCustomRequest(t,a),mutationKey:["update-custom-request"],onSuccess:()=>{s.invalidateQueries({queryKey:["custom-requests"]})}})},Ce=s=>s.reduce((t,{key:a,value:r})=>(a.trim()&&(t[a]=r),t),{}),ve=s=>Object.entries(s).map(([t,a])=>({key:t,value:a}));class Te{constructor(t){this.method=t.method,this.title=t.title,this.path=t.path,this.params=Ce(t.params),this.json=t.json?JSON.parse(t.json):{},this.data=t.data,this.bodyType=t.bodyType,this.id=t.id}}const P=s=>{try{const t=typeof s=="string"?JSON.parse(s):s;return JSON.stringify(t,null,2)}catch(t){return console.error("Invalid JSON:",t),""}},qe=()=>{const s=ye(),t=we(),a=j.use.request(),r=j.use.setRequest();return{onSubmit:o=>{const i=new Te({...o,params:o.params.filter(d=>d.key&&d.value)});a?t.mutate({id:i.id,newCustomRequestData:i}):s.mutate(i),r(i)},isLoading:s.isPending||t.isPending}},Se=(s,t,a)=>{let r="";for(;s.length>0;){const n=s.match(t);n?(r+=s.slice(0,n.index),r+=a(n),s=s.slice(n.index+n[0].length)):(r+=s,s="")}return r},ge=(s="")=>{const t=[];let a="";return Se(s,/\s*(?:([^\s\\\'\"]+)|'((?:[^\'\\]|\\.)*)'|"((?:[^\"\\]|\\.)*)"|(\\.?)|(\S))(\s|$)?/,r=>{const[n,o,i,d,u,l,c]=r;if(l!=null)throw new Error("Unmatched quote");a+=o||(i||d||u).replace(/\\(?=.)/,""),c!=null&&(t.push(a),a="")}),a&&t.push(a),t};function ke(s){if(s.indexOf("curl ")==0){var t=Re(ge(s)),a={method:"GET",header:{}},r="";return t.forEach(function(n){switch(!0){case Ee(n):a.url=n;break;case(n=="-A"||n=="--user-agent"):r="user-agent";break;case(n=="-H"||n=="--header"):r="header";break;case(n=="-d"||n=="--data"||n=="--data-ascii"||n=="--data-raw"):r="data";break;case(n=="-u"||n=="--user"):r="user";break;case(n=="-I"||n=="--head"):a.method="HEAD";break;case(n=="-X"||n=="--request"):r="method";break;case(n=="-b"||n=="--cookie"):r="cookie";break;case n=="--compressed":a.header["Accept-Encoding"]=a.header["Accept-Encoding"]||"deflate, gzip";break;case(n=="-F"||n=="--form"):r="form-data";break;case!!n:switch(r){case"form-data":a.data=a.data||[],a.data.push(n),r="";break;case"header":var o=Pe(n);a.header[o[0]]=o[1],r="";break;case"user-agent":a.header["User-Agent"]=n,r="";break;case"data":(a.method=="GET"||a.method=="HEAD")&&(a.method="POST"),a.header["Content-Type"]=a.header["Content-Type"]||"application/x-www-form-urlencoded",a.body=a.body?a.body+"&"+n:n,r="";break;case"user":a.header.Authorization="Basic "+btoa(n),r="";break;case"method":a.method=n,r="";break;case"cookie":a.header["Set-Cookie"]=n,r="";break}break}}),a}}function Re(s){return s.reduce(function(t,a){return a.indexOf("-X")==0?(t.push("-X"),t.push(a.slice(2))):t.push(a),t},[])}function Pe(s){return s.split(/: (.+)/)}function Ee(s){return/^https?:\/\//.test(s)}function Oe({e:s,setValue:t,trigger:a,remove:r,append:n,resetField:o}){s.preventDefault();const i=s.clipboardData.getData("text").trim();let d;try{d=new URL(i),t("path",d.pathname.substring(1)),a("path");const u={};for(const[c,h]of d.searchParams.entries())u[c]=h;const l=Object.entries(u).map(([c,h])=>({key:c,value:h}));r(),l.length>0&&n([...l]),n([{key:"",value:""}])}catch{try{const l=ke(i);t("method",l.method||"GET"),a("method");const c=new URL(l.url);t("path",c.pathname.substring(1)),a("path");const h={};for(const[f,T]of c.searchParams.entries())h[f]=T;const S=Object.entries(h).map(([f,T])=>({key:f,value:T}));r(),S.length>0&&n([...S]),n([{key:"",value:""}]),o("body"),o("data"),o("bodyType"),l.body&&(t("bodyType","JSON"),t("json",P(l.body))),l.data&&(t("bodyType","x-www-form-urlencoded"),t("data",l.data.join("&")),a("bodyType"))}catch(l){console.log(l.message),t("path",i)}}}const Ie=s=>{const t=$({defaultValues:s,mode:"onChange"}),{fields:a,append:r,remove:n}=Z({control:t.control,name:"params"}),o=p.useCallback((i,d)=>{const u=i===a.length-1,{id:l,...c}=d,h=fe(c);u&&!h&&r({key:"",value:"",active:!1}),!u&&h&&n(i),t.setValue(`params.${i}`,d),t.trigger(`params.${i}`)},[a,r,n,t]);return{...t,paramsFields:a,append:r,remove:n,handleParamChange:o}},Be=({control:s,errors:t})=>e.jsx("div",{}),Je=({control:s,errors:t})=>e.jsx("div",{}),De=({param:s,onChange:t,error:a,...r})=>{const[n,o]=p.useState(s),i=u=>{const{name:l,value:c}=u.target;o(h=>({...h,[l]:c}))},d=()=>{t(n)};return e.jsxs(oe,{...r,children:[e.jsx(D,{children:e.jsx(v,{defaultValue:s.key,name:"key",onChange:i,onBlur:d,size:"small",placeholder:"key",fullWidth:!0,variant:"standard",slotProps:{input:{disableUnderline:!0}},error:a})}),e.jsx(D,{children:e.jsx(v,{defaultValue:s.value,name:"value",onChange:i,onBlur:d,size:"small",placeholder:"value",fullWidth:!0,variant:"standard",slotProps:{input:{disableUnderline:!0}},error:a})})]})},Le=({paramsFields:s,onChange:t,errors:a})=>e.jsx(ie,{sx:{flexGrow:1,paddingBlock:1,scrollbarWidth:"thin"},children:e.jsx(le,{children:e.jsx(de,{children:s.map((r,n)=>{var o;return e.jsx(De,{param:r,onChange:i=>t(i,n),error:!!((o=a.params)!=null&&o[n])},r.id)})})})}),Ae=p.forwardRef(({value:s,onChange:t,...a},r)=>e.jsxs(ee,{ref:r,value:s,onChange:t,sx:{minWidth:100},variant:"standard",disableUnderline:!0,...a,children:[e.jsx(w,{value:"GET",children:"GET"}),e.jsx(w,{value:"POST",children:"POST"}),e.jsx(w,{value:"PATCH",children:"PATCH"}),e.jsx(w,{value:"DELETE",children:"DELETE"}),e.jsx(w,{value:"OPTIONS",children:"OPTIONS"})]})),Ne=({control:s,errors:t,onPaste:a})=>e.jsx(C,{name:"path",control:s,rules:{required:"Path is required"},render:({field:r})=>{var n;return e.jsx(v,{...r,label:"Request",fullWidth:!0,onPaste:a,sx:{height:"100%"},slotProps:{input:{startAdornment:e.jsx(ue,{position:"start",children:e.jsx(C,{name:"method",control:s,rules:{required:"Method is required"},render:({field:o})=>e.jsx(Ae,{...o})})}),placeholder:"your/request/path"}},error:!!t.path,helperText:(n=t.path)==null?void 0:n.message})}}),Me=({control:s,bodyTypeWatch:t,validateBody:a,errors:r,onJsonBlur:n})=>e.jsxs(e.Fragment,{children:[e.jsx(C,{name:"bodyType",control:s,rules:{required:"Body type is required"},render:({field:o})=>e.jsxs(ce,{row:!0,...o,children:[e.jsx(L,{value:"JSON",control:e.jsx(A,{}),label:"JSON"}),e.jsx(L,{value:"x-www-form-urlencoded",control:e.jsx(A,{}),label:"x-www-form-urlencoded"})]})}),t==="JSON"&&e.jsx(C,{name:"json",control:s,rules:{validate:a},render:({field:o})=>{var i;return e.jsx(v,{...o,label:"Valid json",multiline:!0,rows:8,error:!!r.json,helperText:(i=r.json)==null?void 0:i.message,onBlur:n})}}),t==="x-www-form-urlencoded"&&e.jsx(C,{name:"data",control:s,render:({field:o})=>{var i;return e.jsx(v,{...o,label:"Data",multiline:!0,rows:8,error:!!r.data,helperText:(i=r.data)==null?void 0:i.message})}})]}),Fe=({title:s,onChange:t})=>{const[a,r]=p.useState(!1),[n,o]=p.useState(s),i=()=>{r(!1);const l=n.trim();if(!l){d();return}o(l),t(l)},d=()=>{r(!1),o(s),t(s)},u=l=>{l.key==="Enter"&&i(),l.key==="Escape"&&d()};return p.useEffect(()=>{o(s)},[s]),a?e.jsx(v,{value:n,onChange:l=>o(l.target.value),onBlur:i,onKeyDown:u,autoFocus:!0,fullWidth:!0,size:"small",variant:"standard",slotProps:{input:{disableUnderline:!0}},sx:{"& .MuiInputBase-input":{fontSize:"1.44rem",fontWeight:400,padding:0}}}):e.jsx(M,{sx:{width:"100%",cursor:"pointer",whiteSpace:"nowrap",overflow:"hidden"},children:e.jsx(b,{sx:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",flexGrow:1},variant:"H5",onClick:()=>r(!0),children:s})})},N=()=>({method:"GET",path:"",json:"{}",data:"",params:[{key:"",value:"",avtive:!1}],bodyType:"JSON",title:"New request",id:pe()}),Ge=({...s})=>{const t=j.use.request(),{handleSubmit:a,control:r,formState:{errors:n,isValid:o,isDirty:i},setValue:d,trigger:u,reset:l,resetField:c,watch:h,paramsFields:S,append:f,remove:T,handleParamChange:U}=Ie(N());p.useEffect(()=>(t?(l({...t,json:P(t.json),params:[...ve(t.params)]}),f({key:"",value:""})):l(N()),()=>l()),[t,l,f]);const{onSubmit:z,isLoading:W}=qe(),[q,K]=p.useState(0),X=(m,y)=>{K(y)},k=h("bodyType"),Q=p.useCallback(m=>{if(k==="JSON"&&m.trim())try{return JSON.parse(m),!0}catch{return"Invalid JSON format"}return!0},[k]),_=async m=>{const y=m.target.value;try{const B=JSON.parse(y.trim()),V=P(B);d("json",V),await u("json")}catch{d("json",y.trim()),await u("json")}},Y=m=>{Oe({e:m,setValue:d,trigger:u,remove:T,append:f,resetField:c})};return e.jsxs(x,{...s,gap:2,component:"form",onSubmit:a(z),justifyContent:"space-between",children:[e.jsxs(x,{gap:2,children:[e.jsx(C,{name:"title",control:r,render:({field:m})=>e.jsx(Fe,{title:m.value,onChange:m.onChange})}),e.jsx(x,{direction:"row",gap:2,paddingTop:2,children:e.jsx(Ne,{control:r,errors:n,onPaste:Y})}),e.jsxs(he,{value:q,onChange:X,"aria-label":"basic tabs example",children:[e.jsx(g,{label:"Query"}),e.jsx(g,{label:"Body"}),e.jsx(g,{label:"Headers"}),e.jsx(g,{label:"Cookies"})]}),q===0&&e.jsx(Le,{onChange:(m,y)=>U(y,m),paramsFields:S,errors:n}),q===1&&e.jsx(Me,{onJsonBlur:_,control:r,bodyTypeWatch:k,validateBody:Q,errors:n}),q===3&&e.jsx(Je,{control:r,errors:n}),q===4&&e.jsx(Be,{control:r,errors:n})]}),e.jsx(M,{textAlign:"end",children:e.jsx(te,{type:"submit",variant:"contained",sx:{minWidth:"100px"},disabled:!o||!i,loading:W,children:t?"Update":"Save"})})]})},He=F(e.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m4 11h-3v3c0 .55-.45 1-1 1s-1-.45-1-1v-3H8c-.55 0-1-.45-1-1s.45-1 1-1h3V8c0-.55.45-1 1-1s1 .45 1 1v3h3c.55 0 1 .45 1 1s-.45 1-1 1"}),"AddCircleRounded"),Ue=()=>{const s=j.use.unsetRequest(),t=j.use.request();return e.jsx(G,{disablePadding:!0,children:e.jsx(H,{disabled:!t,onClick:()=>{s()},children:e.jsx(x,{width:"100%",gap:1,direction:"row",alignItems:"center",justifyContent:"center",children:e.jsx(He,{})})})})},ze=F(e.jsx("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V9c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2zM18 4h-2.5l-.71-.71c-.18-.18-.44-.29-.7-.29H9.91c-.26 0-.52.11-.7.29L8.5 4H6c-.55 0-1 .45-1 1s.45 1 1 1h12c.55 0 1-.45 1-1s-.45-1-1-1"}),"DeleteRounded"),We=({request:s})=>{const t=j.use.setRequest(),a=j.use.request(),r=j.use.unsetRequest(),n=be(),[o,i]=p.useState(null),d=c=>{c.preventDefault(),i(o===null?{mouseX:c.clientX+2,mouseY:c.clientY-6}:null)},u=()=>{i(null)},l=()=>{n.mutate(s.id),(a==null?void 0:a.id)===s.id&&r(),u()};return e.jsxs(e.Fragment,{children:[e.jsx(G,{disablePadding:!0,onContextMenu:d,children:e.jsx(se,{title:s.path,disableInteractive:!0,children:e.jsx(H,{selected:s.id===(a==null?void 0:a.id),onClick:()=>{t(s)},children:e.jsxs(x,{gap:1,direction:"row",alignItems:"center",sx:{width:"100%",whiteSpace:"nowrap",overflow:"hidden"},children:[e.jsx(b,{variant:"caption",color:"textSecondary",minWidth:"50px",children:s.method}),e.jsx(b,{sx:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",flexGrow:1},children:s.title})]})})})}),e.jsx(ae,{open:o!==null,onClose:u,anchorReference:"anchorPosition",anchorPosition:o!==null?{top:o.mouseY,left:o.mouseX}:void 0,children:e.jsxs(w,{onClick:l,children:[e.jsx(xe,{children:e.jsx(ze,{fontSize:"small"})}),e.jsx(je,{children:"Delete"})]})})]})},Ke=({...s})=>{const{data:t,isError:a,isLoading:r}=me();return r?e.jsx(x,{gap:2,justifyContent:"center",alignItems:"center",sx:{height:"100%"},...s,children:e.jsx(ne,{})}):a?e.jsx(x,{gap:2,justifyContent:"center",alignItems:"center",sx:{height:"100%"},...s,children:e.jsx(b,{variant:"H5",color:"error",children:"Error"})}):e.jsxs(x,{gap:2,...s,children:[e.jsx(b,{variant:"H5",children:"Your requests"}),!t.length&&e.jsx(b,{variant:"Body",color:"textSecondary",children:"Empty for now"}),t.length?e.jsx(Ue,{}):null,e.jsx(re,{children:t.map((n,o)=>e.jsx(We,{request:n},o))})]})},Ve=()=>e.jsxs(x,{gap:4,flexGrow:1,maxWidth:"100%",children:[e.jsx(b,{variant:"H3",children:"Requests"}),e.jsxs(R,{container:!0,spacing:2,sx:{flexGrow:1},children:[e.jsx(R,{size:3,children:e.jsx(J,{sx:{height:"100%",padding:2},children:e.jsx(Ke,{})})}),e.jsx(R,{size:"grow",children:e.jsx(J,{sx:{height:"100%"},children:e.jsx(x,{sx:{height:"100%"},gap:2,padding:2,children:e.jsx(Ge,{flexGrow:1})})})})]})]});export{Ve as default};
