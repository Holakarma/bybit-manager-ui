import{g as D,r as y,j as e,am as S,e as X,T as v,ac as oe,ad as g,aM as ie,aN as le,S as j,aO as q,B as de,G as Q,aj as ue,aJ as ce,an as he,L as me,al as A,P as H}from"./index-BdHuzUY6.js";import{a as J,u as pe,L as _,b as Y,c as xe,d as je}from"./index-CmDrbGp4.js";import{l as L,j as fe,b as U,m as C,I as ye,f as be,g as W,h as we,i as ve,k as Ce,R as Te,d as z,e as V,u as qe}from"./selectedRequest-Czjz-dXu.js";import{i as ge}from"./isEmptyValues-BYo5e0_1.js";const Se=()=>{const t=D();return J({mutationFn:async s=>await L.addCustomRequest(s),mutationKey:["add-custom-request"],onSuccess:()=>{t.invalidateQueries({queryKey:["custom-requests"]})}})},ke=()=>{const t=D();return J({mutationFn:async s=>await L.deleteCustomRequest(s),mutationKey:["delete-custom-request"],onSuccess:()=>{t.invalidateQueries({queryKey:["custom-requests"]})}})},Re=()=>{const t=D();return J({mutationFn:async({id:s,newCustomRequestData:a})=>await L.updateCustomRequest(s,a),mutationKey:["update-custom-request"],onSuccess:()=>{t.invalidateQueries({queryKey:["custom-requests"]})}})},Pe=t=>t.reduce((s,{key:a,value:r})=>(a.trim()&&(s[a]=r),s),{}),Ee=t=>Object.entries(t).map(([s,a])=>({key:s,value:a}));class Oe{constructor(s){this.method=s.method,this.title=s.title,this.path=s.path,this.params=Pe(s.params),this.json=s.json?JSON.parse(s.json):{},this.data=s.data,this.bodyType=s.bodyType,this.id=s.id}}const Ie=(t,s,a)=>{let r="";for(;t.length>0;){const n=t.match(s);n?(r+=t.slice(0,n.index),r+=a(n),t=t.slice(n.index+n[0].length)):(r+=t,t="")}return r},Ae=(t="")=>{const s=[];let a="";return Ie(t,/\s*(?:([^\s\\\'\"]+)|'((?:[^\'\\]|\\.)*)'|"((?:[^\"\\]|\\.)*)"|(\\.?)|(\S))(\s|$)?/,r=>{const[n,l,h,x,u,d,m]=r;if(d!=null)throw new Error("Unmatched quote");a+=l||(h||x||u).replace(/\\(?=.)/,""),m!=null&&(s.push(a),a="")}),a&&s.push(a),s};function Be(t){if(t.indexOf("curl ")==0){var s=De(Ae(t)),a={method:"GET",header:{}},r="";return s.forEach(function(n){switch(!0){case Le(n):a.url=n;break;case(n=="-A"||n=="--user-agent"):r="user-agent";break;case(n=="-H"||n=="--header"):r="header";break;case(n=="-d"||n=="--data"||n=="--data-ascii"||n=="--data-raw"):r="data";break;case(n=="-u"||n=="--user"):r="user";break;case(n=="-I"||n=="--head"):a.method="HEAD";break;case(n=="-X"||n=="--request"):r="method";break;case(n=="-b"||n=="--cookie"):r="cookie";break;case n=="--compressed":a.header["Accept-Encoding"]=a.header["Accept-Encoding"]||"deflate, gzip";break;case(n=="-F"||n=="--form"):r="form-data";break;case!!n:switch(r){case"form-data":a.data=a.data||[],a.data.push(n),r="";break;case"header":var l=Je(n);a.header[l[0]]=l[1],r="";break;case"user-agent":a.header["User-Agent"]=n,r="";break;case"data":(a.method=="GET"||a.method=="HEAD")&&(a.method="POST"),a.header["Content-Type"]=a.header["Content-Type"]||"application/x-www-form-urlencoded",a.body=a.body?a.body+"&"+n:n,r="";break;case"user":a.header.Authorization="Basic "+btoa(n),r="";break;case"method":a.method=n,r="";break;case"cookie":a.header["Set-Cookie"]=n,r="";break}break}}),a}}function De(t){return t.reduce(function(s,a){return a.indexOf("-X")==0?(s.push("-X"),s.push(a.slice(2))):s.push(a),s},[])}function Je(t){return t.split(/: (.+)/)}function Le(t){return/^https?:\/\//.test(t)}const B=t=>{try{const s=typeof t=="string"?JSON.parse(t):t;return JSON.stringify(s,null,2)}catch(s){return console.error("Invalid JSON:",s),""}},Ne=({param:t,onChange:s,error:a,...r})=>{const[n,l]=y.useState(t),h=u=>{const{name:d,value:m}=u.target;l(k=>({...k,[d]:m}))},x=()=>{s(n)};return e.jsxs(fe,{...r,children:[e.jsx(U,{children:e.jsx(S,{defaultValue:t.key,name:"key",onChange:h,onBlur:x,size:"small",placeholder:"key",fullWidth:!0,variant:"standard",slotProps:{input:{disableUnderline:!0}},error:a})}),e.jsx(U,{children:e.jsx(S,{defaultValue:t.value,name:"value",onChange:h,onBlur:x,size:"small",placeholder:"value",fullWidth:!0,variant:"standard",slotProps:{input:{disableUnderline:!0}},error:a})})]})},Me=({title:t,onChange:s})=>{const[a,r]=y.useState(!1),[n,l]=y.useState(t),h=()=>{r(!1);const d=n.trim();if(!d){x();return}l(d),s(d)},x=()=>{r(!1),l(t),s(t)},u=d=>{d.key==="Enter"&&h(),d.key==="Escape"&&x()};return y.useEffect(()=>{l(t)},[t]),a?e.jsx(S,{value:n,onChange:d=>l(d.target.value),onBlur:h,onKeyDown:u,autoFocus:!0,fullWidth:!0,size:"small",variant:"standard",slotProps:{input:{disableUnderline:!0}},sx:{"& .MuiInputBase-input":{fontSize:"1.44rem",fontWeight:400,padding:0}}}):e.jsx(X,{sx:{width:"100%",cursor:"pointer",whiteSpace:"nowrap",overflow:"hidden"},children:e.jsx(v,{sx:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",flexGrow:1},variant:"H5",onClick:()=>r(!0),children:t})})},Ge=y.forwardRef(({value:t,onChange:s,...a},r)=>e.jsxs(oe,{ref:r,value:t,onChange:s,sx:{minWidth:100},variant:"standard",disableUnderline:!0,...a,children:[e.jsx(g,{value:"GET",children:"GET"}),e.jsx(g,{value:"POST",children:"POST"}),e.jsx(g,{value:"PATCH",children:"PATCH"}),e.jsx(g,{value:"DELETE",children:"DELETE"}),e.jsx(g,{value:"OPTIONS",children:"OPTIONS"})]})),K=()=>({method:"GET",path:"",json:"{}",data:"",params:[{key:"",value:""}],bodyType:"JSON",title:"New request",id:pe()}),Fe=({...t})=>{const s=C.use.request(),a=C.use.setRequest(),{control:r,handleSubmit:n,formState:{errors:l,isValid:h,isDirty:x},setValue:u,trigger:d,reset:m,resetField:k,watch:$}=ie({defaultValues:s||K(),mode:"onChange"}),{fields:N,append:w,remove:P}=le({control:r,name:"params"});y.useEffect(()=>(s?(m({...s,json:B(s.json),params:[...Ee(s.params)]}),w({key:"",value:""})):m(K()),()=>m()),[s,m,w]);const M=Se(),G=Re(),Z=o=>{const i=new Oe({...o,params:o.params.filter(c=>c.key&&c.value)});s?G.mutate({id:i.id,newCustomRequestData:i}):M.mutate(i),a(i)},ee=(o,i)=>{const c=o===N.length-1,{id:b,...p}=i,f=ge(p);c&&!f&&w({key:"",value:""}),!c&&f&&P(o),u(`params.${o}`,i),d(`params.${o}`)},[E,te]=y.useState(0),se=(o,i)=>{te(i)},R=$("bodyType"),ae=y.useCallback(o=>{if(R==="JSON"&&o.trim())try{return JSON.parse(o),!0}catch{return"Invalid JSON format"}return!0},[R]),ne=async o=>{const i=o.target.value;try{const c=JSON.parse(i.trim()),b=B(c);u("json",b),await d("json")}catch{u("json",i.trim()),await d("json")}},re=o=>{o.preventDefault();const i=o.clipboardData.getData("text").trim();let c;try{c=new URL(i),u("path",c.pathname.substring(1)),d("path");const b={};for(const[f,T]of c.searchParams.entries())b[f]=T;const p=Object.entries(b).map(([f,T])=>({key:f,value:T}));P(),p.length>0&&w([...p]),w([{key:"",value:""}])}catch{try{const p=Be(i);u("method",p.method||"GET"),d("method");const f=new URL(p.url);u("path",f.pathname.substring(1)),d("path");const T={};for(const[O,I]of f.searchParams.entries())T[O]=I;const F=Object.entries(T).map(([O,I])=>({key:O,value:I}));P(),F.length>0&&w([...F]),w([{key:"",value:""}]),k("body"),k("data"),k("bodyType"),p.body&&(u("bodyType","JSON"),u("json",B(p.body))),p.data&&(u("bodyType","x-www-form-urlencoded"),u("data",p.data.join("&")),d("bodyType"))}catch{u("path",i)}}};return e.jsxs(j,{...t,gap:2,component:"form",onSubmit:n(Z),justifyContent:"space-between",children:[e.jsxs(j,{gap:2,children:[e.jsx(q,{name:"title",control:r,render:({field:o})=>e.jsx(Me,{title:o.value,onChange:o.onChange})}),e.jsx(j,{direction:"row",gap:2,paddingTop:2,children:e.jsx(q,{name:"path",control:r,rules:{required:"Path is required"},render:({field:o})=>{var i;return e.jsx(S,{...o,label:"Request",fullWidth:!0,onPaste:re,sx:{height:"100%"},slotProps:{input:{startAdornment:e.jsx(ye,{position:"start",children:e.jsx(q,{name:"method",control:r,rules:{required:"Method is required"},render:({field:c})=>e.jsx(Ge,{...c})})}),placeholder:"your/request/path"}},error:!!l.path,helperText:(i=l.path)==null?void 0:i.message})}})}),e.jsxs(be,{value:E,onChange:se,"aria-label":"basic tabs example",children:[e.jsx(W,{label:"Query"}),e.jsx(W,{label:"Body"})]}),E===0&&e.jsx(we,{sx:{flexGrow:1,paddingBlock:1,scrollbarWidth:"thin"},children:e.jsx(ve,{children:e.jsx(Ce,{children:N.map((o,i)=>{var c;return e.jsx(Ne,{param:o,onChange:b=>ee(i,b),error:!!((c=l.params)!=null&&c[i])},o.id)})})})}),E===1&&e.jsxs(e.Fragment,{children:[e.jsx(q,{name:"bodyType",control:r,rules:{required:"Body type is required"},render:({field:o})=>e.jsxs(Te,{row:!0,...o,children:[e.jsx(z,{value:"JSON",control:e.jsx(V,{}),label:"JSON"}),e.jsx(z,{value:"x-www-form-urlencoded",control:e.jsx(V,{}),label:"x-www-form-urlencoded"})]})}),R==="JSON"&&e.jsx(q,{name:"json",control:r,rules:{validate:ae},render:({field:o})=>{var i;return e.jsx(S,{...o,label:"Valid json",multiline:!0,rows:8,error:!!l.json,helperText:(i=l.json)==null?void 0:i.message,onBlur:ne})}}),R==="x-www-form-urlencoded"&&e.jsx(q,{name:"data",control:r,render:({field:o})=>{var i;return e.jsx(S,{...o,label:"Data",multiline:!0,rows:8,error:!!l.data,helperText:(i=l.data)==null?void 0:i.message})}})]})]}),e.jsx(X,{textAlign:"end",children:e.jsx(de,{type:"submit",variant:"contained",sx:{minWidth:"100px"},disabled:!h||!x,loading:M.isPending||G.isPending,children:s?"Update":"Save"})})]})},He=Q(e.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m4 11h-3v3c0 .55-.45 1-1 1s-1-.45-1-1v-3H8c-.55 0-1-.45-1-1s.45-1 1-1h3V8c0-.55.45-1 1-1s1 .45 1 1v3h3c.55 0 1 .45 1 1s-.45 1-1 1"}),"AddCircleRounded"),Ue=()=>{const t=C.use.unsetRequest(),s=C.use.request();return e.jsx(_,{disablePadding:!0,children:e.jsx(Y,{disabled:!s,onClick:()=>{t()},children:e.jsx(j,{width:"100%",gap:1,direction:"row",alignItems:"center",justifyContent:"center",children:e.jsx(He,{})})})})},We=Q(e.jsx("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V9c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2zM18 4h-2.5l-.71-.71c-.18-.18-.44-.29-.7-.29H9.91c-.26 0-.52.11-.7.29L8.5 4H6c-.55 0-1 .45-1 1s.45 1 1 1h12c.55 0 1-.45 1-1s-.45-1-1-1"}),"DeleteRounded"),ze=({request:t})=>{const s=C.use.setRequest(),a=C.use.request(),r=C.use.unsetRequest(),n=ke(),[l,h]=y.useState(null),x=m=>{m.preventDefault(),h(l===null?{mouseX:m.clientX+2,mouseY:m.clientY-6}:null)},u=()=>{h(null)},d=()=>{n.mutate(t.id),r(),u()};return e.jsxs(e.Fragment,{children:[e.jsx(_,{disablePadding:!0,onContextMenu:x,children:e.jsx(ue,{title:t.path,disableInteractive:!0,children:e.jsx(Y,{selected:t.id===(a==null?void 0:a.id),onClick:()=>{s(t)},children:e.jsxs(j,{gap:1,direction:"row",alignItems:"center",sx:{width:"100%",whiteSpace:"nowrap",overflow:"hidden"},children:[e.jsx(v,{variant:"caption",color:"textSecondary",minWidth:"50px",children:t.method}),e.jsx(v,{sx:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",flexGrow:1},children:t.title})]})})})}),e.jsx(ce,{open:l!==null,onClose:u,anchorReference:"anchorPosition",anchorPosition:l!==null?{top:l.mouseY,left:l.mouseX}:void 0,children:e.jsxs(g,{onClick:d,children:[e.jsx(xe,{children:e.jsx(We,{fontSize:"small"})}),e.jsx(je,{children:"Delete"})]})})]})},Ve=({...t})=>{const{data:s,isError:a,isLoading:r}=qe();return r?e.jsx(j,{gap:2,justifyContent:"center",alignItems:"center",sx:{height:"100%"},...t,children:e.jsx(he,{})}):a?e.jsx(j,{gap:2,justifyContent:"center",alignItems:"center",sx:{height:"100%"},...t,children:e.jsx(v,{variant:"H5",color:"error",children:"Error"})}):e.jsxs(j,{gap:2,...t,children:[e.jsx(v,{variant:"H5",children:"Your requests"}),!s.length&&e.jsx(v,{textAlign:"center",variant:"Body",color:"textSecondary",children:"Empty for now"}),s.length?e.jsx(Ue,{}):null,e.jsx(me,{children:s.map((n,l)=>e.jsx(ze,{request:n},l))})]})},Ye=()=>e.jsxs(j,{gap:4,flexGrow:1,maxWidth:"100%",children:[e.jsx(v,{variant:"H3",children:"Requests"}),e.jsxs(A,{container:!0,spacing:2,sx:{flexGrow:1},children:[e.jsx(A,{size:3,children:e.jsx(H,{sx:{height:"100%",padding:2},children:e.jsx(Ve,{})})}),e.jsx(A,{size:"grow",children:e.jsx(H,{sx:{height:"100%"},children:e.jsx(j,{sx:{height:"100%"},gap:2,padding:2,children:e.jsx(Fe,{flexGrow:1})})})})]})]});export{Ye as default};
